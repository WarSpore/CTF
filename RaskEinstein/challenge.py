from Crypto.Util.number import bytes_to_long, isPrime

# Note: parameters.py is purposefully not included in the challenge handout
from parameters import E, c, v, q, gamma, p

with open("flag.txt", "r") as fin:
    flag = fin.read().strip().encode()

m = bytes_to_long(flag)

assert isPrime(q) == True
assert E == gamma * m * c**2 % q
assert p == gamma * m * v % q
assert gamma**2 % q == pow(1 - v**2 * pow(c, -2, q), -1, q)

print(f"{E = }")
print(f"{c = }")
print(f"{v = }")
print(f"{q = }")

# Output:
# E = 65537
# c = 42863630919983371044479600495101425468940214748098950614537167230522611852908495061786383505040865371417150544463907816267261982055532001315873021363398743216702192862220197069211177595251116925391267854644446467010011377711743862132034427485091905967226677285863555510908427765699618239596660215305188399467
# v = 121456175577805699355742783034180730693470876768350494734173796696025149295453137000302458720761350756664964614548747600275148120468754949990858142346346747097339760652563112840875642815529393201682639904038618104016504154879340903951481300293620691542049214439403638584738259311950262808420504606644081561095
# q = 145128210869029541153623250851302298165357388797513222334229309170163385830522939271910551383146034484907190419497707670229373278853595181357038487339240266546279470662587288828567140318144653758756198369925443624414204321852730916392286678634279468595566820994772044680703664599296896345474576977995180372891
