import codecs, re

n  = Integer(96685821958083526684938680238271304286887980859392922334047044570819254535637534763165507014186569373580269436562287115575895071477094697751185058766474544708343165263644182297048851208627306861544906558700694910255483830223450427540731613986917757415247541102253686241820221043700623282515147528145504812161)
ct1 = Integer(31415617614942980419493801728329478459882170524654275330189702271291172239569974917796230082992620119324013322311500280165046115132115888952730272833129650105740565501270236988682510607126061981801996717672566496111413558704046446132351270004211376270714769910968931266620926532143617027921568831958784579911)
ct2 = Integer(72563774621694978528581466712845934115989091233025298416607646944054938010207983336599181951465053976617135146411342652500844040957885351294246597514830545442455636203961703603515841401653220929094734409672423770927867923227749902813163411103868690480354808090999202815188200468063383568781761012284874177390)
e        = 3             
flag_len = 28                 
total_len = 120               
pad_bytes = b"OAEP" * 23            
L         = 111908562165754956052771175359515175806060611549355192656517781814849690011957365722488986741316927984590801540720291425076613139779507830255984402207175985567129284409687767574351653799297983026863454934116540723761333584           # numeric value of the suffix
shift     = 8 * len(pad_bytes)              
B_shift = 1 << (8*len(pad_bytes))                
PR.<X> = PolynomialRing(Zmod(n))
f = (X * B_shift + L)**e - ct1                    
lc       = int(f.leading_coefficient())
f_monic  = (inverse_mod(lc, n) * f).monic()
bound = 1 << (8*flag_len)  
roots = f_monic.small_roots(bound, beta=1/3,  epsilon=0.01)
print(roots)

print("flag =", root)

rotflag = codecs.encode(flag, "rot13")
assert pow(bytes_to_long(rotflag.encode()), e, n) == ct2
