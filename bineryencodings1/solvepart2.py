from Crypto.Util.number import getPrime, long_to_bytes, bytes_to_long

def gcd_extended(a, b):
    if a == 0:
        return b, 0, 1
    gcd, x1, y1 = gcd_extended(b % a, a)
    x = y1 - (b // a) * x1
    y = x1
    return gcd, x, y

def find_min_x(num, rem):
    prod = 1
    for n in num:
        prod *= n

    result = 0
    for i in range(len(num)):
        prod_i = prod // num[i]
        _, inv_i, _ = gcd_extended(prod_i, num[i])
        result += rem[i] * prod_i * inv_i

    return result % prod

num = [9768317032740503603, 18156330420060477793, 10476762262519913959, 9347882639404620023, 11430937203592009097, 17656701845837939561, 10011069635378637821, 9303859140428609923, 9430685689565848129, 17610703349508968921, 18140526684492216101, 13376315490931891063, 14024438832046178891, 14707324533024715489, 9978269176741957331, 13426850418503228437, 17886189966641892589, 12567016417937207657, 11734576994202379979, 18381970530468107443, 15834975197593730861, 11304987454211866601, 13069720355679787001, 9607164897014498981, 9825483122269264409, 9608454472360228451, 11677408947673812151, 11577075391109060227, 15098908071687008909, 11940695074819110637, 9277500110378312383, 11325145340975252239]
rem = [9575104083177283048, 654829914826964428, 8717987845758977868, 3299732009405467865, 10473741261900299814, 2405639366022411754, 2194862298102476068, 6748703991871530302, 3454422808257998182, 13565185375904130809, 8709537670581362149, 12293453432959068747, 13229847825294716454, 3056173638526417581, 65599736668218521, 11398473528376442350, 8576657917939379051, 9129425845766533589, 8594293513869774248, 5775640393641471384, 349917141893968095, 3066029727228120275, 5587833707329530308, 9401495996680306807, 8904901928481653836, 7591248352665021199, 10878696646715348869, 10506002541042515302, 4781246273357667663, 7834587634360970146, 2068533696716192161, 6693265025140266855]


def binarify(m):
    return int.from_bytes(bin(int.from_bytes(m, "big")).encode(), "big")

x =  find_min_x(num, rem)
flagbyte = long_to_bytes(x)
flagbin = flagbyte.decode()
flagint = (int(flagbin[2:],2))
flag = long_to_bytes(flagint)
print(flag)
